!function(factory){"use strict";"object"==typeof exports?module.exports=factory("undefined"!=typeof angular?angular:require("angular"),"undefined"!=typeof Chart?Chart:require("chart.js")):"function"==typeof define&&define.amd?define(["angular","chart"],factory):factory(angular,Chart)}(function(angular,Chart){"use strict";function ChartJsProvider(){var options={},ChartJs={Chart:Chart,getOptions:function(type){var typeOptions=type&&options[type]||{};return angular.extend({},options,typeOptions)}};this.setOptions=function(type,customOptions){return customOptions?void(options[type]=angular.extend(options[type]||{},customOptions)):(customOptions=type,void(options=angular.extend(options,customOptions)))},this.$get=function(){return ChartJs}}function ChartJsFactory(ChartJs,$timeout){function canUpdateChart(newVal,oldVal){return!!(newVal&&oldVal&&newVal.length&&oldVal.length)&&(Array.isArray(newVal[0])?newVal.length===oldVal.length&&newVal.every(function(element,index){return element.length===oldVal[index].length}):oldVal.reduce(sum,0)>0&&newVal.length===oldVal.length)}function sum(carry,val){return carry+val}function getEventHandler(scope,chart,action,triggerOnlyOnChange){var lastState=null;return function(evt){var atEvent=chart.getPointsAtEvent||chart.getBarsAtEvent||chart.getSegmentsAtEvent;if(atEvent){var activePoints=atEvent.call(chart,evt);triggerOnlyOnChange!==!1&&angular.equals(lastState,activePoints)!==!1||(lastState=activePoints,scope[action](activePoints,evt),scope.$apply())}}}function getColours(type,scope){for(var notEnoughColours=!1,colours=angular.copy(scope.colours||ChartJs.getOptions(type).colours||Chart.defaults.global.colours);colours.length<scope.data.length;)colours.push(scope.getColour()),notEnoughColours=!0;return notEnoughColours&&(scope.colours=colours),colours.map(convertColour)}function convertColour(colour){return"object"==typeof colour&&null!==colour?colour:"string"==typeof colour&&"#"===colour[0]?getColour(hexToRgb(colour.substr(1))):getRandomColour()}function getRandomColour(){var colour=[getRandomInt(0,255),getRandomInt(0,255),getRandomInt(0,255)];return getColour(colour)}function getColour(colour){return{fillColor:rgba(colour,.2),strokeColor:rgba(colour,1),pointColor:rgba(colour,1),pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:rgba(colour,.8)}}function getRandomInt(min,max){return Math.floor(Math.random()*(max-min+1))+min}function rgba(colour,alpha){return usingExcanvas?"rgb("+colour.join(",")+")":"rgba("+colour.concat(alpha).join(",")+")"}function hexToRgb(hex){var bigint=parseInt(hex,16),r=bigint>>16&255,g=bigint>>8&255,b=255&bigint;return[r,g,b]}function getDataSets(labels,data,series,colours){return{labels:labels,datasets:data.map(function(item,i){return angular.extend({},colours[i],{label:series[i],data:item})})}}function getData(labels,data,colours){return labels.map(function(label,i){return angular.extend({},colours[i],{label:label,value:data[i],color:colours[i].strokeColor,highlight:colours[i].pointHighlightStroke})})}function setLegend(elem,chart){var $parent=elem.parent(),$oldLegend=$parent.find("chart-legend"),legend="<chart-legend>"+chart.generateLegend()+"</chart-legend>";$oldLegend.length?$oldLegend.replaceWith(legend):$parent.append(legend)}function updateChart(chart,values,scope,elem){Array.isArray(scope.data[0])?chart.datasets.forEach(function(dataset,i){(dataset.points||dataset.bars).forEach(function(dataItem,j){dataItem.value=values[i][j]})}):chart.segments.forEach(function(segment,i){segment.value=values[i]}),chart.update(),scope.$emit("update",chart),scope.legend&&"false"!==scope.legend&&setLegend(elem,chart)}function isEmpty(value){return!value||Array.isArray(value)&&!value.length||"object"==typeof value&&!Object.keys(value).length}function isResponsive(type,scope){var options=angular.extend({},Chart.defaults.global,ChartJs.getOptions(type),scope.options);return options.responsive}return function(type){return{restrict:"CA",scope:{data:"=?",labels:"=?",options:"=?",series:"=?",colours:"=?",getColour:"=?",chartType:"=",legend:"@",click:"=?",hover:"=?",chartData:"=?",chartLabels:"=?",chartOptions:"=?",chartSeries:"=?",chartColours:"=?",chartLegend:"@",chartClick:"=?",chartHover:"=?"},link:function(scope,elem){function aliasVar(fromName,toName){scope.$watch(fromName,function(newVal){"undefined"!=typeof newVal&&(scope[toName]=newVal)})}function resetChart(newVal,oldVal){if(!isEmpty(newVal)&&!angular.equals(newVal,oldVal)){var chartType=type||scope.chartType;chartType&&(chart&&chart.destroy(),createChart(chartType))}}function createChart(type){if(isResponsive(type,scope)&&0===elem[0].clientHeight&&0===container.clientHeight)return $timeout(function(){createChart(type)},50,!1);if(scope.data&&scope.data.length){scope.getColour="function"==typeof scope.getColour?scope.getColour:getRandomColour;var colours=getColours(type,scope),cvs=elem[0],ctx=cvs.getContext("2d"),data=Array.isArray(scope.data[0])?getDataSets(scope.labels,scope.data,scope.series||[],colours):getData(scope.labels,scope.data,colours),options=angular.extend({},ChartJs.getOptions(type),scope.options);chart=new ChartJs.Chart(ctx)[type](data,options),scope.$emit("create",chart),cvs.onclick=scope.click?getEventHandler(scope,chart,"click",!1):angular.noop,cvs.onmousemove=scope.hover?getEventHandler(scope,chart,"hover",!0):angular.noop,scope.legend&&"false"!==scope.legend&&setLegend(elem,chart)}}function deprecated(attr){if("undefined"!=typeof console&&"test"!==ChartJs.getOptions().env){var warn="function"==typeof console.warn?console.warn:console.log;scope[attr]&&warn.call(console,'"%s" is deprecated and will be removed in a future version. Please use "chart-%s" instead.',attr,attr)}}var chart,container=document.createElement("div");container.className="chart-container",elem.replaceWith(container),container.appendChild(elem[0]),usingExcanvas&&window.G_vmlCanvasManager.initElement(elem[0]),["data","labels","options","series","colours","legend","click","hover"].forEach(deprecated),aliasVar("chartData","data"),aliasVar("chartLabels","labels"),aliasVar("chartOptions","options"),aliasVar("chartSeries","series"),aliasVar("chartColours","colours"),aliasVar("chartLegend","legend"),aliasVar("chartClick","click"),aliasVar("chartHover","hover"),scope.$watch("data",function(newVal,oldVal){if(newVal&&newVal.length&&(!Array.isArray(newVal[0])||newVal[0].length)){var chartType=type||scope.chartType;if(chartType){if(chart){if(canUpdateChart(newVal,oldVal))return updateChart(chart,newVal,scope,elem);chart.destroy()}createChart(chartType)}}},!0),scope.$watch("series",resetChart,!0),scope.$watch("labels",resetChart,!0),scope.$watch("options",resetChart,!0),scope.$watch("colours",resetChart,!0),scope.$watch("chartType",function(newVal,oldVal){isEmpty(newVal)||angular.equals(newVal,oldVal)||(chart&&chart.destroy(),createChart(newVal))}),scope.$on("$destroy",function(){chart&&chart.destroy()})}}}}Chart.defaults.global.responsive=!0,Chart.defaults.global.multiTooltipTemplate="<%if (datasetLabel){%><%=datasetLabel%>: <%}%><%= value %>",Chart.defaults.global.colours=["#97BBCD","#DCDCDC","#F7464A","#46BFBD","#FDB45C","#949FB1","#4D5360"];var usingExcanvas="object"==typeof window.G_vmlCanvasManager&&null!==window.G_vmlCanvasManager&&"function"==typeof window.G_vmlCanvasManager.initElement;return usingExcanvas&&(Chart.defaults.global.animation=!1),angular.module("chart.js",[]).provider("ChartJs",ChartJsProvider).factory("ChartJsFactory",["ChartJs","$timeout",ChartJsFactory]).directive("chartBase",["ChartJsFactory",function(ChartJsFactory){return new ChartJsFactory}]).directive("chartLine",["ChartJsFactory",function(ChartJsFactory){return new ChartJsFactory("Line")}]).directive("chartBar",["ChartJsFactory",function(ChartJsFactory){return new ChartJsFactory("Bar")}]).directive("chartRadar",["ChartJsFactory",function(ChartJsFactory){return new ChartJsFactory("Radar")}]).directive("chartDoughnut",["ChartJsFactory",function(ChartJsFactory){return new ChartJsFactory("Doughnut")}]).directive("chartPie",["ChartJsFactory",function(ChartJsFactory){return new ChartJsFactory("Pie")}]).directive("chartPolarArea",["ChartJsFactory",function(ChartJsFactory){return new ChartJsFactory("PolarArea")}])});